{"title":"Laravel常用命令","date":"2020-04-07T06:28:19.000Z","date_formatted":{"ll":"Apr 7, 2020","L":"04/07/2020","MM-DD":"04-07"},"link":"Learning/05e70c5ba457","tags":["Laravel","PHP"],"categories":["Learning"],"updated":"2023-11-14T12:07:06.466Z","content":"<h2 id=\"常用命令\">常用命令<a title=\"#常用命令\" href=\"#常用命令\"></a></h2>\n<p>这些都是我在做毕业设计中，常用的命令，久了不用就忘，恼火<br>\n我是一个小小的前端，这些个东西就不想记了，写下来，忘了就来复制粘贴</p>\n<ul>\n<li>安装依赖：<code>composer install</code></li>\n<li>生成密钥：<code>php artisan key:generate</code></li>\n<li>启动本地服务：<code>php artisan serve</code></li>\n<li>创建\n<ul>\n<li>创建数据表：<code>php artisan make:migration r_users --create=r_users</code></li>\n<li>创建模型：<code>php artisan make:model RUsers</code>  -m 带数据表，-c 带控制器， -r 带路由</li>\n<li>创建控制器：<code>php artisan make:controller RUsersController</code>  --resource 带有Rest风格方法</li>\n<li>创建中间件：<code>php artisan make:middleware filterTime</code></li>\n</ul>\n</li>\n<li>生成数据表：<code>php artisan migrate</code></li>\n<li>清空数据表：<code>php artisan migrate:refresh</code>  :reset 删除所有数据表</li>\n<li>部署启动：<code>php artisan up</code></li>\n</ul>\n<p><strong>备注：</strong><br>\nlaravel中的数据表都使用复数形式（users）<br>\n默认CRUD检索id字段为<code>id</code>，因此尽量不自定义id字段</p>\n<blockquote>\n<p>更多 <a href=\"https://www.cnblogs.com/myzan/p/12000857.html\">https://www.cnblogs.com/myzan/p/12000857.html</a></p>\n</blockquote>\n<h2 id=\"数据表范例\">数据表范例<a title=\"#数据表范例\" href=\"#数据表范例\"></a></h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">up</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"title class_\">Schema</span>::<span class=\"title function_ invoke__\">create</span>(<span class=\"string\">&#x27;r_xxs&#x27;</span>, function (Blueprint <span class=\"variable\">$table</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$table</span>-&gt;<span class=\"title function_ invoke__\">increments</span>(<span class=\"string\">&#x27;id&#x27;</span>);</span><br><span class=\"line\">        <span class=\"variable\">$table</span>-&gt;<span class=\"keyword\">integer</span>(<span class=\"string\">&#x27;calorie&#x27;</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>)-&gt;<span class=\"title function_ invoke__\">nullable</span>()-&gt;<span class=\"title function_ invoke__\">comment</span>(<span class=\"string\">&#x27;卡路里&#x27;</span>);</span><br><span class=\"line\">        <span class=\"variable\">$table</span>-&gt;<span class=\"title function_ invoke__\">bigInteger</span>(<span class=\"string\">&#x27;rid&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">foreign</span>(<span class=\"string\">&#x27;rid&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">references</span>(<span class=\"string\">&#x27;rid&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">on</span>(<span class=\"string\">&#x27;r_users&#x27;</span>);</span><br><span class=\"line\">        <span class=\"variable\">$table</span>-&gt;<span class=\"title function_ invoke__\">tinyInteger</span>(<span class=\"string\">&#x27;sex&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">nullable</span>()-&gt;<span class=\"title function_ invoke__\">comment</span>(<span class=\"string\">&#x27;性别:0位置1男2女&#x27;</span>);</span><br><span class=\"line\">        <span class=\"variable\">$table</span>-&gt;<span class=\"keyword\">string</span>(<span class=\"string\">&#x27;openid&#x27;</span>, <span class=\"number\">50</span>)-&gt;<span class=\"title function_ invoke__\">unique</span>()-&gt;<span class=\"title function_ invoke__\">comment</span>(<span class=\"string\">&#x27;openid&#x27;</span>);</span><br><span class=\"line\">        <span class=\"variable\">$table</span>-&gt;<span class=\"title function_ invoke__\">timestamp</span>(<span class=\"string\">&#x27;time_start&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">nullable</span>()-&gt;<span class=\"title function_ invoke__\">comment</span>(<span class=\"string\">&#x27;开始时间&#x27;</span>); </span><br><span class=\"line\">        <span class=\"variable\">$table</span>-&gt;<span class=\"title function_ invoke__\">timestamps</span>(); <span class=\"comment\">//自动添加created_at和updated_at字段</span></span><br><span class=\"line\">        <span class=\"comment\">// $table-&gt;primary([&#x27;rid&#x27;]);</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"中间件范例\">中间件范例<a title=\"#中间件范例\" href=\"#中间件范例\"></a></h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">handle</span>(<span class=\"params\"><span class=\"variable\">$request</span>, <span class=\"built_in\">Closure</span> <span class=\"variable\">$next</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;   </span><br><span class=\"line\">    <span class=\"comment\">// 过滤掉时间</span></span><br><span class=\"line\">    <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">offsetUnset</span>(<span class=\"string\">&#x27;created_at&#x27;</span>);</span><br><span class=\"line\">    <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">offsetUnset</span>(<span class=\"string\">&#x27;updated_at&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"variable\">$next</span>(<span class=\"variable\">$request</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//Kernel.php中注册</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"variable\">$routeMiddleware</span> = [</span><br><span class=\"line\">    <span class=\"string\">&#x27;auth&#x27;</span> =&gt; <span class=\"title class_\">\\App\\Http\\Middleware\\Authenticate</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;auth.basic&#x27;</span> =&gt; <span class=\"title class_\">\\Illuminate\\Auth\\Middleware\\AuthenticateWithBasicAuth</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;bindings&#x27;</span> =&gt; <span class=\"title class_\">\\Illuminate\\Routing\\Middleware\\SubstituteBindings</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;cache.headers&#x27;</span> =&gt; <span class=\"title class_\">\\Illuminate\\Http\\Middleware\\SetCacheHeaders</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;can&#x27;</span> =&gt; <span class=\"title class_\">\\Illuminate\\Auth\\Middleware\\Authorize</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;guest&#x27;</span> =&gt; <span class=\"title class_\">\\App\\Http\\Middleware\\RedirectIfAuthenticated</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;signed&#x27;</span> =&gt; <span class=\"title class_\">\\Illuminate\\Routing\\Middleware\\ValidateSignature</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;throttle&#x27;</span> =&gt; <span class=\"title class_\">\\Illuminate\\Routing\\Middleware\\ThrottleRequests</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;verified&#x27;</span> =&gt; <span class=\"title class_\">\\Illuminate\\Auth\\Middleware\\EnsureEmailIsVerified</span>::<span class=\"variable language_\">class</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 自定义中间件</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;filterTime&#x27;</span> =&gt; \\App\\Http\\Middleware\\filter<span class=\"title class_\">Time</span>::<span class=\"variable language_\">class</span></span><br><span class=\"line\">];</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//路由中使用</span></span><br><span class=\"line\"><span class=\"title class_\">Route</span>::<span class=\"title function_ invoke__\">prefix</span>(<span class=\"string\">&#x27;user&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">group</span>(function () &#123;</span><br><span class=\"line\">\t<span class=\"title class_\">Route</span>::<span class=\"title function_ invoke__\">post</span>(<span class=\"string\">&#x27;/doUpdate&#x27;</span>, <span class=\"string\">&#x27;RUsersController@doUpdate&#x27;</span>)-&gt;<span class=\"title function_ invoke__\">middleware</span>(<span class=\"string\">&#x27;filterTime&#x27;</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n","prev":{"title":"YApi平台以及pm2管理","link":"Learning/f360ef90efef"},"next":{"title":"Laravel后端问题整理","link":"Learning/ab11027998a1"},"plink":"https://blog.jschef.com/Learning/05e70c5ba457/","toc":[{"id":"常用命令","title":"常用命令","index":"1"},{"id":"数据表范例","title":"数据表范例","index":"2"},{"id":"中间件范例","title":"中间件范例","index":"3"}],"reward":true,"copyright":{"author":"Chef Wu","link":"<a href=\"https://blog.jschef.com/Learning/05e70c5ba457/\" title=\"Laravel常用命令\">https://blog.jschef.com/Learning/05e70c5ba457/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"April 7, 2020"}}