{"title":"Vue更新data后没有渲染html问题","date":"2019-01-02T03:19:00.000Z","date_formatted":{"ll":"Jan 2, 2019","L":"01/02/2019","MM-DD":"01-02"},"link":"Learning/077017a6a342","tags":["JavaScript","Vue"],"categories":["Learning"],"updated":"2023-11-14T12:07:06.466Z","content":"<h2 id=\"问题源码\">问题源码<a title=\"#问题源码\" href=\"#问题源码\"></a></h2>\n<p>  这是我做课程设计时遇到的一个让我抓狂的问题，本来元旦三天的，我花了两天写前端。然后写完前端那天晚上就开始配置后端SSM框架，额，一直报错，找不到控制器controller，然后各种抓狂心态爆炸的去查这改那，知道第二天晚上（昨天晚上）在大佬 <strong>Hashq</strong> 帮我找到原因，缺少一个**@ Controller**。然后后端问题终于解决了嘛，我就怀着愉快的心情奋奋地想在昨天晚上多写点接口。但是！但是！我测试的时候，前端页面能获取到数据，但是就是没有渲染出来，具体代码如下：<br>\nJavaScript:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">\t\t\t<span class=\"attr\">el</span>: <span class=\"string\">&quot;#vueroot&quot;</span>,      <span class=\"comment\">//vue控制挂载点</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">data</span>: &#123;       <span class=\"comment\">//数据</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">hotFlowers</span>: []</span><br><span class=\"line\">\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t<span class=\"attr\">methods</span>:&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">getHotFlowers</span>:<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t$.<span class=\"title function_\">getJSON</span>(<span class=\"string\">&quot;getHotFlowers&quot;</span>,<span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"variable language_\">this</span>.<span class=\"property\">hotFlowers</span> = data;</span><br><span class=\"line\">\t\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//生命周期函数</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">created</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"variable language_\">this</span>.<span class=\"property\">$options</span>.<span class=\"property\">methods</span>.<span class=\"title function_\">getHotFlowers</span>();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;)</span><br></pre></td></tr></table></figure>\n<p>Html:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;bd-con-hot-item&quot;</span> <span class=\"attr\">v-for</span>=<span class=\"string\">&quot;item in hotFlowers&quot;</span> &gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;bd-con-hot-item-pic&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">v-bind:src</span>=<span class=\"string\">&quot;[&#x27;img/flower/&#x27;+item.picture]&quot;</span> /&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;bd-con-hot-item-name&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;bd-con-hot-item-price&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>¥&#123;&#123;item.price&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"解决过程\">解决过程<a title=\"#解决过程\" href=\"#解决过程\"></a></h2>\n<p>  然后就是死活就是渲染不出来，真是心态爆炸，我起先怀疑是json格式问题，我尝试了json.parse()；然后怀疑是vue的生命周期函数问题，我尝试了mounted,updated；问题还是没有解决，看网上有人像如下这样写：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> $.<span class=\"title function_\">getJSON</span>(<span class=\"string\">&quot;getHotFlowers&quot;</span>,<span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;</span><br><span class=\"line\">\t <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">\t \t<span class=\"attr\">el</span>: <span class=\"string\">&quot;#vueroot&quot;</span>,</span><br><span class=\"line\">\t \t<span class=\"attr\">data</span>:&#123;</span><br><span class=\"line\">\t\t hotFlowers : data</span><br><span class=\"line\">\t \t&#125;</span><br><span class=\"line\">\t &#125;)</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>  这样写就可以渲染出来，然后我就在想我原来的写法肯定没有将data更新成功，后来我想起了我写微信小程序的时候经常用var that = this，我好像有点思路了，本来对这个理解有点似懂非懂。然后我将代码改成：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//前面代码省略...</span></span><br><span class=\"line\"><span class=\"comment\">//生命周期函数</span></span><br><span class=\"line\">\t<span class=\"attr\">created</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> that = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">\t\t$.<span class=\"title function_\">getJSON</span>(<span class=\"string\">&quot;getHotFlowers&quot;</span>,<span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;</span><br><span class=\"line\">\t\t\tthat.<span class=\"property\">hotFlowers</span> = data;</span><br><span class=\"line\">\t\t&#125;);</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n<p>  <strong>竟然好使了</strong>，然后我就懂了，这次错误还是错在细节问题上。应该在vue实例里用的this作用域是整个vue实例，<strong>但是</strong>，如果是在其内部使用的方法中，再使用this，那个this是指代的那个具体方法，也就是内部this和外部this不是同一个指代。所以，我们要提前区分一下，通过将外部作用的this转移，也就是像我上面那样赋值给that进行转移。然后在内部函数中，that就代表vue实例，此时this就代表$.getJSON。既然问题解决了，我就重新再优化了一下代码，将获取后台数据的方法封装到methods里，然后通过传参that进行vue实例数据更新，详细实现如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span><br><span class=\"line\">\t\t\t<span class=\"attr\">el</span>: <span class=\"string\">&quot;#vueroot&quot;</span>,      <span class=\"comment\">//vue控制挂载点</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">data</span>: &#123;       <span class=\"comment\">//数据</span></span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">hotFlowers</span>: []</span><br><span class=\"line\">\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t<span class=\"attr\">methods</span>:&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"attr\">getHotFlowers</span>:<span class=\"keyword\">function</span> (<span class=\"params\">that</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t$.<span class=\"title function_\">getJSON</span>(<span class=\"string\">&quot;getHotFlowers&quot;</span>,<span class=\"keyword\">function</span>(<span class=\"params\">data</span>)&#123;</span><br><span class=\"line\">\t\t\t\t\t\tthat.<span class=\"property\">hotFlowers</span> = data;</span><br><span class=\"line\">\t\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//生命周期函数</span></span><br><span class=\"line\">\t\t\t<span class=\"attr\">created</span>:<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">var</span> that = <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">\t\t\t\tthat.<span class=\"property\">$options</span>.<span class=\"property\">methods</span>.<span class=\"title function_\">getHotFlowers</span>(that);<span class=\"comment\">//传递that</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"总结\">总结<a title=\"#总结\" href=\"#总结\"></a></h2>\n<p>  都是 <strong>细节</strong> 问题，本来很简单的问题，因为不熟悉，因为缺少经验，但经过撕心裂肺后，这就是经验，学习不止步。</p>\n","prev":{"title":"Spring MVC配置","link":"Learning/280ed29779d2"},"next":{"title":"Vue.js学习笔记","link":"Learning/bc07c5f099c1"},"plink":"https://blog.jschef.com/Learning/077017a6a342/","toc":[{"id":"问题源码","title":"问题源码","index":"1"},{"id":"解决过程","title":"解决过程","index":"2"},{"id":"总结","title":"总结","index":"3"}],"reward":true,"copyright":{"author":"Chef Wu","link":"<a href=\"https://blog.jschef.com/Learning/077017a6a342/\" title=\"Vue更新data后没有渲染html问题\">https://blog.jschef.com/Learning/077017a6a342/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"January 2, 2019"}}