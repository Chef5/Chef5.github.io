{"title":"Spring MVC配置","date":"2019-04-01T14:01:00.000Z","date_formatted":{"ll":"Apr 1, 2019","L":"04/01/2019","MM-DD":"04-01"},"link":"Learning/280ed29779d2","tags":["Spring"],"categories":["Learning"],"updated":"2023-11-14T12:07:06.466Z","content":"<h2 id=\"导入库\">导入库<a title=\"#导入库\" href=\"#导入库\"></a></h2>\n<ul>\n<li>首先新建一个Java Web项目，最后一步选择框架时，此步<strong>不选任何框架</strong>，点击完成；</li>\n<li>然后再新建的项目 “<strong>库</strong>” 上右键 <strong>添加库</strong> ,找到其中的Spring Framework、Spring Web MVC 、JSTL进行添加，前两个Spring库版本号需要一致；</li>\n</ul>\n<h2 id=\"网站设置\">网站设置<a title=\"#网站设置\" href=\"#网站设置\"></a></h2>\n<ul>\n<li>在项目的 <strong>源包（src）</strong> 目录下, 新建Java类：ApplicationInitializer和AppConfig，包：conf，其中类名和包名都可以自己任意起；</li>\n<li>在实现WebApplicationInitializer 的类中对网站进行配置. 这种硬编码的配置方式可以通过编写web.xml进行替换掉, 也就是web.xml优先起作用.</li>\n</ul>\n<p>src/conf/ApplicationInitializer.java：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> conf;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.ServletContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.ServletException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.ServletRegistration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.WebApplicationInitializer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.context.support.AnnotationConfigWebApplicationContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.DispatcherServlet;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ApplicationInitializer</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">WebApplicationInitializer</span> &#123;  <span class=\"comment\">//实现这个接口是关键, 与类名无关.</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onStartup</span><span class=\"params\">(ServletContext servletContext)</span> <span class=\"keyword\">throws</span> ServletException &#123;</span><br><span class=\"line\">        <span class=\"type\">AnnotationConfigWebApplicationContext</span> <span class=\"variable\">annotationConfigWebApplicationContext</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AnnotationConfigWebApplicationContext</span>();</span><br><span class=\"line\">        annotationConfigWebApplicationContext.register(AppConfig.class); <span class=\"comment\">//注册自己定义的AppConfig类.</span></span><br><span class=\"line\">        annotationConfigWebApplicationContext.setServletContext(servletContext);</span><br><span class=\"line\">        ServletRegistration.<span class=\"type\">Dynamic</span> <span class=\"variable\">servlet</span> <span class=\"operator\">=</span> servletContext.addServlet(<span class=\"string\">&quot;dispatcher&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">DispatcherServlet</span>(annotationConfigWebApplicationContext));</span><br><span class=\"line\">        servlet.addMapping(<span class=\"string\">&quot;/&quot;</span>); <span class=\"comment\">//此Servlet负责处理(mapping)除了对Servlet/JSP外的所有(URL)访问</span></span><br><span class=\"line\">        servlet.setLoadOnStartup(<span class=\"number\">1</span>); <span class=\"comment\">//第1个加载这个Servlet. 最先加载的是第0个. </span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>src/conf/AppConfig.java：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> conf;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.config.annotation.EnableWebMvc;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.view.InternalResourceViewResolver;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.view.JstlView;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span>  <span class=\"comment\">//配置如下</span></span><br><span class=\"line\"><span class=\"meta\">@EnableWebMvc</span>   <span class=\"comment\">//允许使用springMVC</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan(basePackages = &#123;&quot;controller&quot;&#125;)</span>  <span class=\"comment\">//扫描controller包中的组件(类)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AppConfig</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">WebMvcConfigurerAdapter</span> &#123; <span class=\"comment\">//类名随意</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span>  <span class=\"comment\">//下面的方法产生一个bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> InternalResourceViewResolver <span class=\"title function_\">createViewResolver</span><span class=\"params\">()</span> &#123; <span class=\"comment\">//方法名随意</span></span><br><span class=\"line\">        <span class=\"type\">InternalResourceViewResolver</span> <span class=\"variable\">viewResolver</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InternalResourceViewResolver</span>();</span><br><span class=\"line\">        viewResolver.setPrefix(<span class=\"string\">&quot;/WEB-INF/view/&quot;</span>); <span class=\"comment\">//前缀</span></span><br><span class=\"line\">        viewResolver.setSuffix(<span class=\"string\">&quot;.jsp&quot;</span>); <span class=\"comment\">//后缀</span></span><br><span class=\"line\">        viewResolver.setViewClass(JstlView.class); <span class=\"comment\">//使用JSTL视图</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> viewResolver;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>对于index.html的请求, 返回的是index加上前后缀. 如上配置的前缀为/WEB-INF/view/, 后缀为.jsp. 最终的视图文件为/WEB-INF/view/index.jsp.</li>\n</ul>\n<h2 id=\"控制器源程序\">控制器源程序<a title=\"#控制器源程序\" href=\"#控制器源程序\"></a></h2>\n<ul>\n<li>在项目的src目录下, 创建Java源程序文件/controller/mainController.java</li>\n</ul>\n<p>src/controller/mainController.java：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> controller;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Controller;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">mainController</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/index&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">hello</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;index&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/login&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">login</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;login&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"视图\">视图<a title=\"#视图\" href=\"#视图\"></a></h2>\n<ul>\n<li>项目的web目录 /WEB-INF/view/ ，可由前面的AppConfig进行配置。在该目录下，创建index.jsp和login.jsp文件。</li>\n</ul>\n<p>/WEB-INF/view/index.jsp：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@page contentType=&quot;text/html&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">&quot;Content-Type&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Index page<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>This is RequestMapping(&quot;/index&quot;) page!!!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;login&quot;</span>&gt;</span>登录<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>/WEB-INF/view/login.jsp：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@page contentType=&quot;text/html&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">&quot;Content-Type&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>login page<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>This is RequestMapping(&quot;/login&quot;) page!!!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">center</span>&gt;</span></span><br><span class=\"line\">            账号：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span>&gt;</span></span><br><span class=\"line\">            密码：<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">center</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"整体结构\">整体结构<a title=\"#整体结构\" href=\"#整体结构\"></a></h2>\n<ul>\n<li>springmvc项目必须添加spring framework的包. 此项目中AppConfig指定使用JSTL视图JstlView.class, 因此还需要添加JSTL的包。项目结构如下：<br>\n<img src=\"images/20190405183928_SpringMVC_1.jpg\" alt=\"image\"></li>\n</ul>\n<h2 id=\"运行结果\">运行结果<a title=\"#运行结果\" href=\"#运行结果\"></a></h2>\n<ul>\n<li>暂时没有，因为我的tomcat服务器出问题了，我还没有解决。运行不出来呀，蓝瘦、、</li>\n</ul>\n","prev":{"title":"ES6学习-变量常量的声明与解构赋值","link":"Learning/90da1569d69e"},"next":{"title":"Vue更新data后没有渲染html问题","link":"Learning/077017a6a342"},"plink":"https://blog.jschef.com/Learning/280ed29779d2/","toc":[{"id":"导入库","title":"导入库","index":"1"},{"id":"网站设置","title":"网站设置","index":"2"},{"id":"控制器源程序","title":"控制器源程序","index":"3"},{"id":"视图","title":"视图","index":"4"},{"id":"整体结构","title":"整体结构","index":"5"},{"id":"运行结果","title":"运行结果","index":"6"}],"reward":true,"copyright":{"author":"Chef Wu","link":"<a href=\"https://blog.jschef.com/Learning/280ed29779d2/\" title=\"Spring MVC配置\">https://blog.jschef.com/Learning/280ed29779d2/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"April 1, 2019"}}